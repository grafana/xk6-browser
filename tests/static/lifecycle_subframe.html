<html>

<head></head>

<body>
    <div id="pingRequestText">Waiting...</div>
    <div id="pingJSText">Waiting...</div>

    <script>
        var pingRequestTextOutput = document.getElementById("pingRequestText");
        var parentOutput = window.parent.document.getElementById('subFramePingRequestText');

        var p = pingRequestText();
        p.then(() => {
            pingRequestTextOutput.innerText += ' - for loop complete';
            if (parentOutput) {
                parentOutput.innerText = pingRequestTextOutput.innerText;
            }
        })

        async function pingRequestText() {
            for (var i = 0; i < 10; i++) {
                await fetch('/ping')
                    .then(response => response.text())
                    .then((data) => {
                        pingRequestTextOutput.innerText = 'Waiting... ' + data;
                        if (parentOutput) {
                            parentOutput.innerText = pingRequestTextOutput.innerText;
                        }
                    });
            }
        }
    </script>
    <script src="/ping.js" async></script>
</body>

</html>